import{d as B,k as _,B as i,r as x,o as V,J as A,e as D,x as g,z as a,O as P,A as v,C as k,y,D as b,_ as F}from"./C57q5Bld.js";import{n as S,t as L,c as O,a as U}from"./DSmQk4JK.js";import{c as W,b as m}from"./BskD4ZCU.js";import{u as z}from"./Ao_tioNJ.js";import{u as E,c as G}from"./B8Rp0WmU.js";const[J,w]=O("progress"),j={color:String,inactive:Boolean,pivotText:String,textColor:String,showPivot:L,pivotColor:String,trackColor:String,strokeWidth:S,percentage:{type:S,default:0,validator:o=>+o>=0&&+o<=100}};var q=B({name:J,props:j,setup(o){const u=_(()=>o.inactive?void 0:o.color),s=n=>Math.min(Math.max(+n,0),100),d=()=>{const{textColor:n,pivotText:r,pivotColor:t,percentage:p}=o,f=s(p),c=r??`${p}%`;if(o.showPivot&&c){const C={color:n,left:`${f}%`,transform:`translate(-${f}%,-50%)`,background:t||u.value};return i("span",{style:C,class:w("pivot",{inactive:o.inactive})},[c])}};return()=>{const{trackColor:n,percentage:r,strokeWidth:t}=o,p=s(r),f={background:n,height:U(t)},c={width:`${p}%`,background:u.value};return i("div",{class:w(),style:f},[i("span",{class:w("portion",{inactive:o.inactive}),style:c},null),d()])}}});const H={class:"page"},K={key:0,class:"card"},Q={class:"row"},X={class:"value"},Y={class:"row"},Z={class:"value"},tt={class:"row"},et={class:"value"},at={key:1,class:"card"},ot={class:"row"},st={class:"value"},nt={class:"row"},lt={class:"value"},rt={key:2,class:"actions"},it={key:3,class:"empty"},ut=B({__name:"index",setup(o){const u=A(),s=z(),d=x(!1),n=x(!0),r=x(!1),t=_(()=>s.playerInfo),p=_(()=>{if(!t.value||t.value.maxCultivation<=0)return 0;const l=t.value.cultivation/t.value.maxCultivation*100;return l<0?0:l>100?100:Math.floor(l)}),f=_(()=>{if(!t.value)return 0;const l=t.value.realm,e=t.value.spiritRoot;return G(e,l)}),c=_(()=>!t.value||t.value.maxCultivation<=0?!1:t.value.cultivation>=t.value.maxCultivation),C=async()=>{if(t.value&&typeof s.cultivate=="function")try{await s.cultivate()}catch(l){const e=l?.message||"修炼失败，请稍后重试";m(e)}},N=async()=>{if(!t.value){m("请先登录"),u.push("/login");return}if(!d.value){d.value=!0;try{await C()}finally{d.value=!1}}},T=async()=>{if(!t.value){m("请先登录"),u.push("/login");return}if(!c.value){m("当前修为尚未圆满");return}if(!r.value&&typeof s.breakthrough=="function"){r.value=!0;try{await s.breakthrough(),m("突破成功！")}catch(l){const e=l?.message||"突破失败，请稍后重试";m(e)}finally{r.value=!1}}},$=()=>{n.value=!n.value},{pause:I,resume:M}=E(()=>{n.value&&t.value&&typeof s.cultivate=="function"&&s.cultivate().catch(()=>{})},1e3,{immediate:!1});return V(async()=>{try{if(t.value||await s.fetchProfile(),!t.value){u.push("/login");return}M()}catch{u.push("/login")}}),D(()=>{I()}),(l,e)=>{const R=q,h=W;return y(),g("div",H,[e[10]||(e[10]=a("div",{class:"header"},[a("h1",{class:"title"},"凡人修仙传·掌上仙途"),a("p",{class:"subtitle"},"静坐吐纳，修炼真元")],-1)),t.value?(y(),g("div",K,[a("div",Q,[e[0]||(e[0]=a("span",{class:"label"},"道号",-1)),a("span",X,v(t.value.username),1)]),a("div",Y,[e[1]||(e[1]=a("span",{class:"label"},"境界",-1)),a("span",Z,v(t.value.realmLabel),1)]),a("div",tt,[e[2]||(e[2]=a("span",{class:"label"},"灵根",-1)),a("span",et,v(t.value.spiritRootLabel),1)])])):P("",!0),t.value?(y(),g("div",at,[a("div",ot,[e[3]||(e[3]=a("span",{class:"label"},"当前修为",-1)),a("span",st,v(t.value.cultivation)+" / "+v(t.value.maxCultivation),1)]),i(R,{percentage:p.value,"show-pivot":!1},null,8,["percentage"]),a("div",nt,[e[4]||(e[4]=a("span",{class:"label"},"修炼速度",-1)),a("span",lt,v(f.value.toFixed(2))+" / 秒 ",1)])])):P("",!0),t.value?(y(),g("div",rt,[i(h,{type:"primary",round:"",block:"",loading:d.value,onClick:N},{default:k(()=>[...e[5]||(e[5]=[b(" 打坐修炼 ",-1)])]),_:1},8,["loading"]),i(h,{type:"success",round:"",block:"",loading:r.value,disabled:!c.value,onClick:T},{default:k(()=>[...e[6]||(e[6]=[b(" 突破 ",-1)])]),_:1},8,["loading","disabled"]),i(h,{type:"default",round:"",block:"",onClick:$},{default:k(()=>[b(v(n.value?"暂停挂机":"开始挂机"),1)]),_:1}),e[7]||(e[7]=a("p",{class:"hint"}," 挂机开启时，每秒自动结算一次修为，离线时间也会在下次结算时一次补齐。 ",-1))])):(y(),g("div",it,[e[9]||(e[9]=a("p",null,"尚未登录，请先前往登录页。",-1)),i(h,{type:"primary",round:"",block:"",to:{path:"/login"}},{default:k(()=>[...e[8]||(e[8]=[b(" 去登录 ",-1)])]),_:1})]))])}}}),mt=F(ut,[["__scopeId","data-v-c00410e2"]]);export{mt as default};
