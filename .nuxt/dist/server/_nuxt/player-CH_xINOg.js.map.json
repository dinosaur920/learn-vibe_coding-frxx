{"file":"player-CH_xINOg.js","mappings":";;AAmCO,MAAM,iBAAiB,YAAY,UAAU;AAAA,EAClD,OAAO,OAAO;AAAA,IACZ,YAAY;AAAA,IACZ,OAAO;AAAA,EAAA;AAAA,EAET,SAAS;AAAA,IACP,MAAM,SAAS,SAA0B;AACvC,YAAM,EAAE,MAAM,MAAA,IAAU,MAAM,SAAsD,sBAAsB;AAAA,QACxG,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA,gBACP;AAED,UAAI,MAAM,OAAO;AACf,cAAM,MAAM;AAAA,MACd;AAEA,UAAI,CAAC,KAAK,OAAO;AACf,cAAM,IAAI,MAAM,MAAM;AAAA,MACxB;AAEA,UAAI,CAAC,KAAK,MAAM,SAAS;AACvB,cAAM,IAAI,MAAM,KAAK,MAAM,OAAO;AAAA,MACpC;AAEA,WAAK,aAAa,KAAK,MAAM;AAAA,IAC/B;AAAA,IACA,MAAM,MAAM,SAAuB;AACjC,YAAM,EAAE,MAAM,MAAA,IAAU,MAAM,SAAsD,mBAAmB;AAAA,QACrG,QAAQ;AAAA,QACR,MAAM;AAAA,MAAA,gBACP;AAED,UAAI,MAAM,OAAO;AACf,cAAM,MAAM;AAAA,MACd;AAEA,UAAI,CAAC,KAAK,OAAO;AACf,cAAM,IAAI,MAAM,MAAM;AAAA,MACxB;AAEA,UAAI,CAAC,KAAK,MAAM,SAAS;AACvB,cAAM,IAAI,MAAM,KAAK,MAAM,OAAO;AAAA,MACpC;AAEA,WAAK,aAAa,KAAK,MAAM;AAAA,IAC/B;AAAA,IACA,MAAM,eAAe;AACnB,YAAM,EAAE,MAAM,MAAA,IAAU,MAAM,SAAsD,qBAAqB;AAAA,QACvG,QAAQ;AAAA,MAAA,gBACT;AAED,UAAI,MAAM,OAAO;AACf,cAAM,MAAM;AAAA,MACd;AAEA,UAAI,CAAC,KAAK,OAAO;AACf,cAAM,IAAI,MAAM,UAAU;AAAA,MAC5B;AAEA,UAAI,CAAC,KAAK,MAAM,SAAS;AACvB,YAAI,KAAK,MAAM,SAAS,qBAAqB;AAC3C,eAAK,aAAa;AAClB,eAAK,QAAQ;AACb;AAAA,QACF;AACA,cAAM,IAAI,MAAM,KAAK,MAAM,OAAO;AAAA,MACpC;AAEA,WAAK,aAAa,KAAK,MAAM;AAAA,IAC/B;AAAA,IACA,MAAM,YAAY;AAChB,YAAM,EAAE,MAAM,MAAA,IAAU,MAAM,SAAsD,uBAAuB;AAAA,QACzG,QAAQ;AAAA,MAAA,gBACT;AAED,UAAI,MAAM,OAAO;AACf,cAAM,MAAM;AAAA,MACd;AAEA,UAAI,CAAC,KAAK,OAAO;AACf,cAAM,IAAI,MAAM,MAAM;AAAA,MACxB;AAEA,UAAI,CAAC,KAAK,MAAM,SAAS;AACvB,YAAI,KAAK,MAAM,SAAS,qBAAqB;AAC3C,eAAK,aAAa;AAClB,eAAK,QAAQ;AACb;AAAA,QACF;AACA,cAAM,IAAI,MAAM,KAAK,MAAM,OAAO;AAAA,MACpC;AAEA,WAAK,aAAa,KAAK,MAAM;AAAA,IAC/B;AAAA,IACA,MAAM,eAAe;AACnB,YAAM,EAAE,MAAM,MAAA,IAAU,MAAM,SAAsD,0BAA0B;AAAA,QAC5G,QAAQ;AAAA,MAAA,gBACT;AAED,UAAI,MAAM,OAAO;AACf,cAAM,MAAM;AAAA,MACd;AAEA,UAAI,CAAC,KAAK,OAAO;AACf,cAAM,IAAI,MAAM,MAAM;AAAA,MACxB;AAEA,UAAI,CAAC,KAAK,MAAM,SAAS;AACvB,YAAI,KAAK,MAAM,SAAS,qBAAqB;AAC3C,eAAK,aAAa;AAClB,eAAK,QAAQ;AACb;AAAA,QACF;AACA,cAAM,IAAI,MAAM,KAAK,MAAM,OAAO;AAAA,MACpC;AAEA,WAAK,aAAa,KAAK,MAAM;AAAA,IAC/B;AAAA,IACA,SAAS;AACP,WAAK,aAAa;AAClB,WAAK,QAAQ;AAAA,IACf;AAAA,EAAA;AAEJ,CAAC;","names":[],"sources":["../../../../stores/player.ts"],"sourcesContent":["import { defineStore } from \"pinia\"\n\nexport type PlayerInfo = {\n  id: number\n  username: string\n  email: string | null\n  realm: string\n  realmLabel: string\n  cultivation: number\n  maxCultivation: number\n  spiritRoot: string\n  spiritRootLabel: string\n}\n\ntype SuccessResponse<T> = {\n  success: true\n  data: T\n}\n\ntype ErrorResponse = {\n  success: false\n  code: string\n  message: string\n}\n\ntype RegisterPayload = {\n  username: string\n  password: string\n}\n\ntype LoginPayload = {\n  username: string\n  password: string\n}\n\nexport const usePlayerStore = defineStore(\"player\", {\n  state: () => ({\n    playerInfo: null as PlayerInfo | null,\n    token: null as string | null\n  }),\n  actions: {\n    async register(payload: RegisterPayload) {\n      const { data, error } = await useFetch<SuccessResponse<PlayerInfo> | ErrorResponse>(\"/api/user/register\", {\n        method: \"POST\",\n        body: payload\n      })\n\n      if (error.value) {\n        throw error.value\n      }\n\n      if (!data.value) {\n        throw new Error(\"注册失败\")\n      }\n\n      if (!data.value.success) {\n        throw new Error(data.value.message)\n      }\n\n      this.playerInfo = data.value.data\n    },\n    async login(payload: LoginPayload) {\n      const { data, error } = await useFetch<SuccessResponse<PlayerInfo> | ErrorResponse>(\"/api/user/login\", {\n        method: \"POST\",\n        body: payload\n      })\n\n      if (error.value) {\n        throw error.value\n      }\n\n      if (!data.value) {\n        throw new Error(\"登录失败\")\n      }\n\n      if (!data.value.success) {\n        throw new Error(data.value.message)\n      }\n\n      this.playerInfo = data.value.data\n    },\n    async fetchProfile() {\n      const { data, error } = await useFetch<SuccessResponse<PlayerInfo> | ErrorResponse>(\"/api/user/profile\", {\n        method: \"GET\"\n      })\n\n      if (error.value) {\n        throw error.value\n      }\n\n      if (!data.value) {\n        throw new Error(\"获取玩家信息失败\")\n      }\n\n      if (!data.value.success) {\n        if (data.value.code === \"AUTH_UNAUTHORIZED\") {\n          this.playerInfo = null\n          this.token = null\n          return\n        }\n        throw new Error(data.value.message)\n      }\n\n      this.playerInfo = data.value.data\n    },\n    async cultivate() {\n      const { data, error } = await useFetch<SuccessResponse<PlayerInfo> | ErrorResponse>(\"/api/game/cultivate\", {\n        method: \"POST\"\n      })\n\n      if (error.value) {\n        throw error.value\n      }\n\n      if (!data.value) {\n        throw new Error(\"修炼失败\")\n      }\n\n      if (!data.value.success) {\n        if (data.value.code === \"AUTH_UNAUTHORIZED\") {\n          this.playerInfo = null\n          this.token = null\n          return\n        }\n        throw new Error(data.value.message)\n      }\n\n      this.playerInfo = data.value.data\n    },\n    async breakthrough() {\n      const { data, error } = await useFetch<SuccessResponse<PlayerInfo> | ErrorResponse>(\"/api/game/breakthrough\", {\n        method: \"POST\"\n      })\n\n      if (error.value) {\n        throw error.value\n      }\n\n      if (!data.value) {\n        throw new Error(\"突破失败\")\n      }\n\n      if (!data.value.success) {\n        if (data.value.code === \"AUTH_UNAUTHORIZED\") {\n          this.playerInfo = null\n          this.token = null\n          return\n        }\n        throw new Error(data.value.message)\n      }\n\n      this.playerInfo = data.value.data\n    },\n    logout() {\n      this.playerInfo = null\n      this.token = null\n    }\n  }\n})\n"],"version":3}