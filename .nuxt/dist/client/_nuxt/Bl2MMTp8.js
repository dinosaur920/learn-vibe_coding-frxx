import{c as V,n as S,t as $,a as D,w as O}from"./CJ14RTpw.js";import{d as M,k as h,B as p,r as w,J as U,K as W,L,M as F,N as G,O as K,o as z,e as H,x as _,y,z as o,P as I,A as m,C,D as b,_ as J}from"./CM7szyLk.js";import{s as j,u as q,a as X,b as g}from"./CvFxpbq6.js";const[Y,x]=V("progress"),Z={color:String,inactive:Boolean,pivotText:String,textColor:String,showPivot:$,pivotColor:String,trackColor:String,strokeWidth:S,percentage:{type:S,default:0,validator:a=>+a>=0&&+a<=100}};var tt=M({name:Y,props:Z,setup(a){const n=h(()=>a.inactive?void 0:a.color),l=r=>Math.min(Math.max(+r,0),100),f=()=>{const{textColor:r,pivotText:s,pivotColor:t,percentage:c}=a,v=l(c),i=s??`${c}%`;if(a.showPivot&&i){const d={color:r,left:`${v}%`,transform:`translate(-${v}%,-50%)`,background:t||n.value};return p("span",{style:d,class:x("pivot",{inactive:a.inactive})},[i])}};return()=>{const{trackColor:r,percentage:s,strokeWidth:t}=a,c=l(s),v={background:r,height:D(t)},i={width:`${c}%`,background:n.value};return p("div",{class:x(),style:v},[p("span",{class:x("portion",{inactive:a.inactive}),style:i},null),f()])}}});O(j);function P(a){return L()?(F(a),!0):!1}function et(a){return typeof a=="function"?a():G(a)}const T=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function at(a,n=1e3,l={}){const{immediate:f=!0,immediateCallback:r=!1}=l;let s=null;const t=w(!1);function c(){s&&(clearInterval(s),s=null)}function v(){t.value=!1,c()}function i(){const d=et(n);d<=0||(t.value=!0,r&&a(),c(),s=setInterval(a,d))}if(f&&T&&i(),U(n)||typeof n=="function"){const d=W(n,()=>{t.value&&T&&i()});P(d)}return P(v),{isActive:t,pause:v,resume:i}}const ot=1,nt={FAKE:.7,TRUE:1,HEAVEN:1.3,MUTANT:1.1},st={QI_1:1,QI_2:1.05,QI_3:1.1,QI_4:1.15,QI_5:1.2,QI_6:1.25,QI_7:1.3,QI_8:1.35,QI_9:1.4,QI_10:1.45};function lt(a){return nt[a]??1}function rt(a){return st[a]??1}function it(a,n){return ot*lt(a)*rt(n)}const ut={class:"page"},ct={key:0,class:"card"},vt={class:"row"},ft={class:"value"},dt={class:"row"},pt={class:"value"},mt={class:"row"},gt={class:"value"},_t={key:1,class:"card"},yt={class:"row"},ht={class:"value"},kt={class:"row"},Ct={class:"value"},bt={key:2,class:"actions"},wt={key:3,class:"empty"},xt=M({__name:"index",setup(a){const n=K(),l=q(),f=w(!1),r=w(!0),s=w(!1),t=h(()=>l.playerInfo),c=h(()=>{if(!t.value||t.value.maxCultivation<=0)return 0;const u=t.value.cultivation/t.value.maxCultivation*100;return u<0?0:u>100?100:Math.floor(u)}),v=h(()=>{if(!t.value)return 0;const u=t.value.realm,e=t.value.spiritRoot;return it(e,u)}),i=h(()=>!t.value||t.value.maxCultivation<=0?!1:t.value.cultivation>=t.value.maxCultivation),d=async()=>{if(t.value&&typeof l.cultivate=="function")try{await l.cultivate()}catch(u){const e=u?.message||"修炼失败，请稍后重试";g(e)}},N=async()=>{if(!t.value){g("请先登录"),n.push("/login");return}if(!f.value){f.value=!0;try{await d()}finally{f.value=!1}}},Q=async()=>{if(!t.value){g("请先登录"),n.push("/login");return}if(!i.value){g("当前修为尚未圆满");return}if(!s.value&&typeof l.breakthrough=="function"){s.value=!0;try{await l.breakthrough(),g("突破成功！")}catch(u){const e=u?.message||"突破失败，请稍后重试";g(e)}finally{s.value=!1}}},R=()=>{r.value=!r.value},{pause:B,resume:A}=at(()=>{r.value&&t.value&&typeof l.cultivate=="function"&&l.cultivate().catch(()=>{})},1e3,{immediate:!1});return z(async()=>{try{if(t.value||await l.fetchProfile(),!t.value){n.push("/login");return}A()}catch{n.push("/login")}}),H(()=>{B()}),(u,e)=>{const E=tt,k=X;return y(),_("div",ut,[e[10]||(e[10]=o("div",{class:"header"},[o("h1",{class:"title"},"凡人修仙传·掌上仙途"),o("p",{class:"subtitle"},"静坐吐纳，修炼真元")],-1)),t.value?(y(),_("div",ct,[o("div",vt,[e[0]||(e[0]=o("span",{class:"label"},"道号",-1)),o("span",ft,m(t.value.username),1)]),o("div",dt,[e[1]||(e[1]=o("span",{class:"label"},"境界",-1)),o("span",pt,m(t.value.realmLabel),1)]),o("div",mt,[e[2]||(e[2]=o("span",{class:"label"},"灵根",-1)),o("span",gt,m(t.value.spiritRootLabel),1)])])):I("",!0),t.value?(y(),_("div",_t,[o("div",yt,[e[3]||(e[3]=o("span",{class:"label"},"当前修为",-1)),o("span",ht,m(t.value.cultivation)+" / "+m(t.value.maxCultivation),1)]),p(E,{percentage:c.value,"show-pivot":!1},null,8,["percentage"]),o("div",kt,[e[4]||(e[4]=o("span",{class:"label"},"修炼速度",-1)),o("span",Ct,m(v.value.toFixed(2))+" / 秒 ",1)])])):I("",!0),t.value?(y(),_("div",bt,[p(k,{type:"primary",round:"",block:"",loading:f.value,onClick:N},{default:C(()=>[...e[5]||(e[5]=[b(" 打坐修炼 ",-1)])]),_:1},8,["loading"]),p(k,{type:"success",round:"",block:"",loading:s.value,disabled:!i.value,onClick:Q},{default:C(()=>[...e[6]||(e[6]=[b(" 突破 ",-1)])]),_:1},8,["loading","disabled"]),p(k,{type:"default",round:"",block:"",onClick:R},{default:C(()=>[b(m(r.value?"暂停挂机":"开始挂机"),1)]),_:1}),e[7]||(e[7]=o("p",{class:"hint"}," 挂机开启时，每秒自动结算一次修为，离线时间也会在下次结算时一次补齐。 ",-1))])):(y(),_("div",wt,[e[9]||(e[9]=o("p",null,"尚未登录，请先前往登录页。",-1)),p(k,{type:"primary",round:"",block:"",to:{path:"/login"}},{default:C(()=>[...e[8]||(e[8]=[b(" 去登录 ",-1)])]),_:1})]))])}}}),Tt=J(xt,[["__scopeId","data-v-c00410e2"]]);export{Tt as default};
